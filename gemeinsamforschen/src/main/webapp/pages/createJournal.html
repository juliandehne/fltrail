<!DOCTYPE html>
<html>
<head>
	<script src="https://cdn.jsdelivr.net/npm/inscrybmde@1.11.3/dist/inscrybmde.min.js"></script>

	<link rel="stylesheet" type="text/css" href="../assets/css/create-journal.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/inscrybmde@1.11.3/dist/inscrybmde.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="../assets/js/utility.js"></script>

	<title>Tagebucheintrag erstellen</title>
</head>
<body>

<h1> Tagebucheintrag erstellen </h1>

<form id="journalform" class="form-journal" method="POST" action="../rest/journal/save">

	<input type="hidden" name="student" value="0">
	<input type="hidden" name="project" value="0">

	<div class="journal-form-container">

		<div class = "journal-form-visibility">
			Sichtbarkeit:
			<select id="visibility" name="visibility" form="journalform">
				<option value="ALL"> Alle </option>
				<option value="GROUP"> Gruppe </option>
				<option value="DOZENT"> Dozent </option>
				<option value="NONE"> Niemand </option>
			</select>
		</div>

		<div class = "journal-form-category">
			Kategorie:
			<select name="category" form="journalform">
				<option value="A"> A </option>
				<option value="B"> B </option>
			</select>
		</div>


		<div class ="journal-form-editor">
				<textarea id = "editor" name="text" form="journalform" >
				</textarea>
		</div>

		<div class="journal-form-buttons">
			<input type="submit">
			<button> Zur&uuml;ck </button>
		</div>

	</div>
</form>

<script>
    /*
*/
    function getQueryVariable(variable)
    {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
            var pair = vars[i].split("=");
            if(pair[0] == variable){return pair[1];}
        }
        return(false);
    }

    $(document).ready(function() {
        var journalID = getQueryVariable("journal");
        console.log(journalID);
        if(journalID){
            $.ajax({
                url: "../rest/journal/"+journalID
            }).then(function(data) {
                $('#editor').append(data.entry);

                //TODO preselet in select tags

                new InscrybMDE({
                    element: document.getElementById("editor"),
                    spellChecker: false,
                    forceSync: true,
                });

                console.log(data);

            });
        }
    })
</script>

</body>
</html>
